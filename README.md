# 有声书播放网站

一个功能完整的有声书播放网站，支持多接口搜索、章节管理、音频播放、历史记录和书架功能。

## 版本对比

- [查看标准版与高级版功能对比图](./img/)

## 目录

- [项目特点](#项目特点)
- [技术栈](#技术栈)
- [快速开始](#快速开始)
- [功能使用](#功能使用)
- [管理员功能](#管理员功能)
- [安全配置](#安全配置)
- [部署建议](#部署建议)
- [目录结构](#目录结构)
- [开发指南](#开发指南)
- [常见问题](#常见问题)
- [贡献指南](#贡献指南)
- [许可证](#许可证)
- [联系方式](#联系方式)

## 项目特点


- 📱 **响应式设计**：适配手机和桌面设备
- 📚 **书架管理**：收藏喜欢的有声书
- 🕒 **播放历史**：自动记录播放进度
- 🔐 **用户认证**：安全的用户登录和注册
- 📢 **公告系统**：管理员可发布系统公告
- 💬 **用户反馈**：用户可提交反馈和建议
- 🛠️ **管理员后台**：完整的管理功能
- 📱 **PWA支持**：可安装为手机应用
- 🔒 **安全防护**：IP黑名单、访问控制等安全措施

## 技术栈

- **后端**：Python 3.9+, Flask, SQLAlchemy
- **数据库**：MySQL
- **前端**：HTML5, CSS3, JavaScript, Bootstrap
- **音频播放**：HTML5 Audio API
- **部署**：Gunicorn, uWSGI

## 快速开始

### 1. 环境要求

- Python 3.9 或更高版本
- MySQL 5.6 或更高版本
- pip 包管理工具

### 2. 安装步骤

#### 步骤 1: 克隆项目

```bash
git clone https://github.com/yourusername/audiobook-website.git
cd audiobook-website
```

#### 步骤 2: 创建虚拟环境（可选但推荐）

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

#### 步骤 3: 安装依赖

```bash
pip install -r requirements.txt
```

#### 步骤 4: 配置环境变量

复制 `.env.example` 文件并重命名为 `.env`，然后根据你的环境修改配置：

```bash
# 复制配置文件
cp .env.example .env

# 编辑 .env 文件，填写你的配置
```

配置说明：

- `MYSQL_HOST`: MySQL 服务器地址
- `MYSQL_PORT`: MySQL 端口号
- `MYSQL_USER`: MySQL 用户名
- `MYSQL_PASSWORD`: MySQL 密码
- `MYSQL_DATABASE`: 数据库名称
- `SECRET_KEY`: 安全密钥，用于 session 加密
- `FLASK_ENV`: 运行环境（development/production）

#### 步骤 5: 初始化数据库

```bash
python init_db.py
```

#### 步骤 6: 启动应用

```bash
# 开发模式
python app.py

# 生产模式（使用 Gunicorn）
gunicorn -c gunicorn_conf.py app:app

# 生产模式（使用 uWSGI）
uwsgi --ini uwsgi.ini
```

### 3. 访问网站

- 开发模式：http://localhost:6221
- 生产模式：根据你的配置，默认为 http://localhost:8000

## 功能使用

### 管理书架

1. 登录网站
2. 在有声书详情页面点击"加入书架"
3. 在"我的书架"页面查看已收藏的有声书
4. 可从书架中移除有声书

### 查看历史记录

1. 登录网站
2. 点击顶部导航栏的"历史记录"
3. 查看最近播放的有声书和章节
4. 点击历史记录可继续播放

### 提交反馈

1. 登录网站
2. 在个人中心页面找到"反馈建议"
3. 填写反馈内容和联系方式
4. 点击提交按钮

### 自定义接口管理

1. 登录网站
2. 管理员可在后台"接口管理"页面添加自定义有声书接口
3. 每个接口需要配置搜索、章节列表和音频URL的字段映射
4. 系统会根据配置自动适配不同接口的返回格式

## 管理员功能

### 登录后台

1. 访问 `/admin` 路径
2. 使用管理员账号登录（默认需要在数据库中创建）

### 发布公告

1. 登录管理员后台
2. 进入"公告管理"
3. 点击"发布公告"
4. 填写公告标题和内容
5. 点击保存按钮

### 管理用户反馈

1. 登录管理员后台
2. 进入"反馈管理"
3. 查看用户提交的反馈
4. 可标记反馈为已处理

### 管理自定义接口

1. 登录管理员后台
2. 进入"接口管理"
3. 点击"添加新接口"
4. 填写接口名称、显示名称和描述
5. 配置接口的字段映射（搜索、章节列表、音频URL）
6. 保存接口配置
7. 可启用/禁用、编辑或删除接口



## 安全配置

### IP黑名单

1. 登录管理员后台
2. 进入"IP管理"
3. 点击"添加黑名单"
4. 填写IP地址和拉黑原因
5. 点击保存按钮

### 安全设置

- 生产环境建议启用 HTTPS
- 定期更新 SECRET_KEY
- 限制登录尝试次数
- 启用 IP 访问日志

## 部署建议

### 生产环境部署

1. 使用 Gunicorn 或 uWSGI 作为应用服务器
2. 使用 Nginx 作为反向代理
3. 启用 HTTPS 加密
4. 配置防火墙规则
5. 定期备份数据库

### 性能优化

- 使用 MySQL 索引优化查询
- 启用缓存机制
- 优化图片资源
- 使用 CDN 加速静态资源

## 目录结构

```
├── middleware/       # 中间件
├── models/           # 数据库模型
├── routes/           # 路由定义
├── static/           # 静态资源（CSS, JS, 图片等）
├── templates/        # HTML模板
├── utils/            # 工具函数
├── app.py            # 应用入口
├── config.py         # 配置文件
├── init_db.py        # 数据库初始化脚本
├── requirements.txt  # 依赖包列表
├── gunicorn_conf.py  # Gunicorn配置
└── uwsgi.ini         # uWSGI配置
```

## 开发指南

### 添加新功能

1. 在 `routes/` 目录添加新的路由
2. 在 `api/` 目录添加新的API接口
3. 在 `templates/` 目录添加新的模板
4. 在 `static/` 目录添加静态资源

### 调试模式

```bash
python app.py
```

调试模式下会自动重新加载代码变更。

### 数据库迁移

当修改数据库模型时，需要重新初始化数据库：

```bash
python init_db.py
```

## 常见问题

### 问题：搜索失败

**解决方法**：
1. 检查自定义接口配置是否正确
2. 检查网络连接
3. 尝试使用其他已配置的接口

### 问题：无法播放音频

**解决方法**：
1. 检查网络连接
2. 检查浏览器是否支持 HTML5 音频
3. 尝试刷新页面

### 问题：登录失败

**解决方法**：
1. 检查用户名和密码是否正确
2. 检查数据库连接是否正常
3. 查看日志文件了解详细错误

## 贡献指南

欢迎贡献代码和提出建议！

### 贡献步骤

1. Fork 本仓库
2. 创建新分支
3. 提交代码
4. 创建 Pull Request

### 代码规范

- 遵循 PEP 8 代码规范
- 为新功能添加文档
- 编写清晰的注释

## 许可证

本项目采用 MIT 许可证。详见 LICENSE 文件。

## 联系方式

- 项目地址：https://github.com/yourusername/audiobook-website
- 问题反馈：https://github.com/yourusername/audiobook-website/issues

---

**感谢使用有声书播放网站！** 🎉
